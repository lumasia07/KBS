import{r as l,j as e,H as T,L as D,a as k,t as L}from"./app-XxGQqHEn.js";import{C as B,A as M}from"./app-layout-CPmwDeKB.js";import{T as H,a as P,b as c,c as n,d as R,e as a}from"./table-CkgMGDrt.js";import{B as d}from"./button-Bl64q_Yk.js";import{B as A}from"./badge-BHeNVAji.js";import{I as E}from"./input-BJMzkf2c.js";import{D as z,a as F,b as O,c as U,d as $}from"./dialog-C34YEPG_.js";import{C as q}from"./calendar-UXQyMkf0.js";import{C as V}from"./circle-check-big-B8rD91MQ.js";import{C as G}from"./clock-DBVgPFXR.js";import{P as J}from"./plus-DIkrfwwE.js";import{S as K}from"./search-CT3nxiHW.js";import{L as Q}from"./loader-circle-D76T6EdY.js";import{M as W}from"./x-CTpenCwg.js";import{E as X}from"./eye-DE1ZWiW3.js";import{C as Y}from"./chevron-left-BnVSDa1W.js";import{C as Z}from"./chevron-right-BxG1ta4i.js";/* empty css            */import"./Combination-DsTawVx1.js";import"./createLucideIcon-B9VDQ0kY.js";import"./index-CjOQgEXZ.js";import"./index-EBLA1b0H.js";import"./users-BhW82ob4.js";function we({stats:o={total:0,today:0,completed:0,pending:0}}){const[h,u]=l.useState([]),[b,p]=l.useState(!0),[r,f]=l.useState(0),[i,m]=l.useState(1),[x,g]=l.useState(""),[t,N]=l.useState(null),[v,j]=l.useState(!1),C=async()=>{p(!0);try{const s=await k.get("/agent/inspections",{params:{draw:Date.now(),start:(i-1)*10,length:10,search:{value:x,regex:!1}},headers:{Accept:"application/json"}});u(s.data.data),f(s.data.recordsTotal)}catch(s){console.error("Failed to fetch inspections",s),L.error("Failed to load inspections")}finally{p(!1)}};l.useEffect(()=>{const s=setTimeout(()=>C(),300);return()=>clearTimeout(s)},[i,x]);const w=s=>new Date(s).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),y=s=>{switch(s){case"completed":return"bg-emerald-100 text-emerald-800";case"in_progress":return"bg-blue-100 text-blue-800";case"requires_followup":return"bg-amber-100 text-amber-800";default:return"bg-slate-100 text-slate-800"}},_=Math.ceil(r/10),S=[{label:"Total Inspections",value:o.total,icon:B,bgColor:"#1e40af"},{label:"Today's",value:o.today,icon:q,bgColor:"#059669"},{label:"Completed",value:o.completed,icon:V,bgColor:"#7c3aed"},{label:"In Progress",value:o.pending,icon:G,bgColor:"#d97706"}];return e.jsxs(M,{breadcrumbs:[{title:"Inspections",href:"/agent/inspections"}],children:[e.jsx(T,{title:"My Inspections"}),e.jsxs("div",{className:"flex h-full flex-1 flex-col gap-6 p-6 bg-slate-50",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold tracking-tight text-slate-900",children:"My Inspections"}),e.jsx("p",{className:"text-slate-500 text-sm mt-1",children:"View and manage your field inspections."})]}),e.jsx(D,{href:"/agent/inspections/create",children:e.jsxs(d,{className:"bg-blue-600 hover:bg-blue-700",children:[e.jsx(J,{className:"h-4 w-4 mr-2"})," New Inspection"]})})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:S.map((s,I)=>e.jsx("div",{style:{backgroundColor:s.bgColor},className:"rounded-xl p-4 text-white shadow-lg",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-white/80",children:s.label}),e.jsx("p",{className:"text-3xl font-bold mt-1",children:s.value})]}),e.jsx(s.icon,{className:"h-10 w-10 text-white/30"})]})},I))}),e.jsxs("div",{className:"flex items-center justify-between gap-4 bg-white p-4 rounded-xl border border-slate-200 shadow-sm",children:[e.jsx("div",{className:"font-medium text-slate-900",children:"Inspection History"}),e.jsxs("div",{className:"relative w-72",children:[e.jsx(K,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-slate-500"}),e.jsx(E,{placeholder:"Search inspections...",className:"pl-9 bg-slate-50",value:x,onChange:s=>{g(s.target.value),m(1)}})]})]}),e.jsxs("div",{className:"rounded-xl border border-slate-200 bg-white shadow-sm overflow-hidden",children:[e.jsxs(H,{children:[e.jsx(P,{className:"bg-slate-50",children:e.jsxs(c,{children:[e.jsx(n,{className:"font-semibold text-slate-600",children:"Control #"}),e.jsx(n,{className:"font-semibold text-slate-600",children:"Business"}),e.jsx(n,{className:"font-semibold text-slate-600",children:"Date"}),e.jsx(n,{className:"font-semibold text-slate-600",children:"Type"}),e.jsx(n,{className:"font-semibold text-slate-600",children:"Compliance"}),e.jsx(n,{className:"font-semibold text-slate-600",children:"Status"}),e.jsx(n,{className:"text-right font-semibold text-slate-600",children:"Actions"})]})}),e.jsx(R,{children:b?e.jsx(c,{children:e.jsx(a,{colSpan:7,className:"h-24 text-center",children:e.jsx(Q,{className:"h-6 w-6 animate-spin mx-auto text-blue-500"})})}):h.length===0?e.jsx(c,{children:e.jsx(a,{colSpan:7,className:"h-24 text-center text-slate-500",children:"No inspections found. Start a new inspection!"})}):h.map(s=>e.jsxs(c,{className:"hover:bg-slate-50/50",children:[e.jsx(a,{className:"font-mono font-medium text-slate-700",children:s.control_number}),e.jsxs(a,{children:[e.jsx("div",{className:"font-medium text-slate-700",children:s.business||s.business_name}),e.jsxs("div",{className:"text-xs text-slate-500 flex items-center gap-1",children:[e.jsx(W,{className:"h-3 w-3"}),s.location_address]})]}),e.jsx(a,{className:"text-slate-600",children:w(s.control_date)}),e.jsx(a,{className:"text-slate-600 capitalize",children:s.control_type?.replace("_"," ")}),e.jsx(a,{children:e.jsx("div",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${parseFloat(s.compliance_rate)>=80?"bg-emerald-100 text-emerald-700":parseFloat(s.compliance_rate)>=50?"bg-amber-100 text-amber-700":"bg-red-100 text-red-700"}`,children:s.compliance_rate})}),e.jsx(a,{children:e.jsx(A,{variant:"outline",className:`${y(s.status)} font-medium`,children:s.status?.replace("_"," ").toUpperCase()})}),e.jsx(a,{className:"text-right",children:e.jsx(d,{variant:"ghost",size:"icon",onClick:()=>{N(s),j(!0)},children:e.jsx(X,{className:"h-4 w-4"})})})]},s.id))})]}),r>0&&e.jsxs("div",{className:"flex items-center justify-between p-4 border-t border-slate-100",children:[e.jsxs("div",{className:"text-sm text-slate-500",children:["Showing ",Math.min((i-1)*10+1,r)," to ",Math.min(i*10,r)," of ",r]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(d,{variant:"outline",size:"sm",onClick:()=>m(s=>s-1),disabled:i===1,children:e.jsx(Y,{className:"h-4 w-4"})}),e.jsx(d,{variant:"outline",size:"sm",onClick:()=>m(s=>s+1),disabled:i>=_,children:e.jsx(Z,{className:"h-4 w-4"})})]})]})]}),e.jsx(z,{open:v,onOpenChange:j,children:e.jsxs(F,{className:"sm:max-w-2xl bg-white",children:[e.jsxs(O,{children:[e.jsxs(U,{children:["Inspection #",t?.control_number]}),e.jsx($,{children:"Inspection details and compliance report"})]}),t&&e.jsxs("div",{className:"grid grid-cols-2 gap-4 py-4",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-500 text-xs",children:"Business"}),e.jsx("p",{className:"font-medium",children:t.business||t.business_name})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-500 text-xs",children:"Location"}),e.jsx("p",{className:"font-medium",children:t.location_address})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-500 text-xs",children:"Items Checked"}),e.jsx("p",{className:"font-medium",children:t.total_items_checked})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-500 text-xs",children:"Compliant"}),e.jsx("p",{className:"font-medium text-emerald-600",children:t.compliant_items})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-500 text-xs",children:"Non-Compliant"}),e.jsx("p",{className:"font-medium text-red-600",children:t.non_compliant_items})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-500 text-xs",children:"Compliance Rate"}),e.jsx("p",{className:"font-bold text-lg",children:t.compliance_rate})]}),t.observations&&e.jsxs("div",{className:"col-span-2",children:[e.jsx("span",{className:"text-slate-500 text-xs",children:"Observations"}),e.jsx("p",{className:"text-sm",children:t.observations})]})]})]})})]})]})}export{we as default};
