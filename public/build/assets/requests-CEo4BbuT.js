import{c as he,r as y,j as s,b as se,t as M,H as fe}from"./app-uM-PAfCE.js";import{a as ue,A as je}from"./app-layout-Dy1iYxBT.js";import{b as Y,e as c,a as Ne,c as o,T as ge,d as be}from"./table-x7K6f6LE.js";import{B as _}from"./button-ViEb6EJD.js";import{B as te}from"./badge-DvSv9WzO.js";import{b as ae,c as le,d as ce,e as re,a as ie,D as oe}from"./dialog-CKy0p5nm.js";import{L as ve}from"./label-DQ7SZYjg.js";import{I as ye}from"./input-QaqkRY8g.js";import{T as _e}from"./textarea-C2NkU47E.js";import{F as ne}from"./users-kadJDkF9.js";import{C as de}from"./circle-alert-BtpF9q-_.js";import{L as me}from"./loader-circle-CDyxlgjH.js";import{C as Ce}from"./circle-check-big-BC7CvNXF.js";import{C as Se}from"./circle-x-DNkEgbQ4.js";/* empty css            */import"./Combination-Bijxp1xg.js";import"./x-oZdVZXX7.js";import"./createLucideIcon-DbKPOAFU.js";import"./index-p1i7ejeS.js";import"./index-EBLA1b0H.js";function Ge(X){const e=he.c(58),{requests:w}=X;let R;e[0]!==w?(R=w===void 0?[]:w,e[0]=w,e[1]=R):R=e[1];const C=R;console.log("AdminProductRequests requests:",C);const[t,xe]=y.useState(null),[q,S]=y.useState(!1),[G,P]=y.useState(!1),[r,Z]=y.useState(""),[l,n]=y.useState(null),[i,ee]=y.useState("");let D;e[2]===Symbol.for("react.memo_cache_sentinel")?(D=a=>{xe(a),ee(a.product.stamp_price?String(a.product.stamp_price):""),S(!0)},e[2]=D):D=e[2];const pe=D;let T;e[3]!==t||e[4]!==i?(T=()=>{t&&(n(t.id),se.post(`/admin/products/requests/${t.id}/approve`,{stamp_price:i},{onSuccess:()=>{M.success("Product approved successfully"),S(!1),n(null)},onError:()=>{M.error("Failed to approve product"),n(null)}}))},e[3]=t,e[4]=i,e[5]=T):T=e[5];const J=T;let k;e[6]!==r||e[7]!==t?(k=()=>{t&&(n(t.id),se.patch(`/admin/products/requests/${t.id}/reject`,{rejection_reason:r},{onSuccess:()=>{M.success("Product rejected"),P(!1),S(!1),Z(""),n(null)},onError:()=>{M.error("Failed to reject product"),n(null)}}))},e[6]=r,e[7]=t,e[8]=k):k=e[8];const K=k;let A,I;e[9]===Symbol.for("react.memo_cache_sentinel")?(A=[{title:"Product Requests",href:"/admin/products/requests"}],I=s.jsx(fe,{title:"Product Requests"}),e[9]=A,e[10]=I):(A=e[9],I=e[10]);let z;e[11]===Symbol.for("react.memo_cache_sentinel")?(z=s.jsx("div",{className:"flex items-center justify-between",children:s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl font-bold tracking-tight text-slate-900",children:"Product Requests"}),s.jsx("p",{className:"text-slate-500 text-sm mt-1",children:"Review and approve new product registrations from taxpayers."})]})}),e[11]=z):z=e[11];let F;e[12]===Symbol.for("react.memo_cache_sentinel")?(F=s.jsx(Ne,{className:"bg-slate-50",children:s.jsxs(Y,{children:[s.jsx(o,{className:"font-semibold text-slate-600",children:"Taxpayer"}),s.jsx(o,{className:"font-semibold text-slate-600",children:"Product"}),s.jsx(o,{className:"font-semibold text-slate-600",children:"Category"}),s.jsx(o,{className:"font-semibold text-slate-600",children:"Price"}),s.jsx(o,{className:"font-semibold text-slate-600",children:"Date"}),s.jsx(o,{className:"font-semibold text-slate-600",children:"Certificate"}),s.jsx(o,{className:"text-right font-semibold text-slate-600",children:"Actions"})]})}),e[12]=F):F=e[12];let d;e[13]!==C?(d=C.length===0?s.jsx(Y,{children:s.jsx(c,{colSpan:7,className:"h-24 text-center text-slate-500",children:"No pending product requests."})}):C.map(a=>s.jsxs(Y,{className:"hover:bg-slate-50/50 transition-colors",children:[s.jsxs(c,{children:[s.jsx("div",{className:"font-medium text-slate-900",children:a.taxpayer.company_name}),s.jsx("div",{className:"text-xs text-slate-500",children:a.taxpayer.tin})]}),s.jsxs(c,{children:[s.jsx("div",{className:"font-medium text-slate-900",children:a.product.name}),s.jsx("div",{className:"text-xs text-slate-500",children:a.product.code})]}),s.jsx(c,{children:s.jsx(te,{variant:"secondary",className:"font-normal capitalize",children:typeof a.product.category=="object"&&a.product.category!==null?String(a.product.category.name||""):String(a.product.category||"")})}),s.jsxs(c,{children:[s.jsxs("div",{className:"text-sm font-medium text-slate-700",children:[Number(a.product.stamp_price).toLocaleString()," CDF"]}),s.jsxs("div",{className:"text-xs text-slate-500 capitalize",children:["Per ",a.product.unit_type]})]}),s.jsx(c,{className:"text-slate-600 text-sm",children:a.date}),s.jsx(c,{children:a.certificate_path?s.jsxs("a",{href:a.certificate_path,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-1.5 text-blue-600 hover:text-blue-800 hover:underline text-sm font-medium",onClick:we,children:[s.jsx(ne,{className:"w-4 h-4"})," View"]}):s.jsxs("span",{className:"text-slate-400 text-xs flex items-center gap-1",children:[s.jsx(de,{className:"w-3 h-3"})," Missing"]})}),s.jsx(c,{className:"text-right",children:s.jsx(_,{variant:"outline",size:"sm",onClick:()=>pe(a),className:"gap-2",children:"Review"})})]},a.id)),e[13]=C,e[14]=d):d=e[14];let m;e[15]!==d?(m=s.jsx("div",{className:"rounded-xl border border-slate-200 bg-white shadow-sm overflow-hidden",children:s.jsxs(ge,{children:[F,s.jsx(be,{children:d})]})}),e[15]=d,e[16]=m):m=e[16];let B;e[17]===Symbol.for("react.memo_cache_sentinel")?(B=s.jsxs(ae,{children:[s.jsxs(le,{className:"text-xl font-bold flex items-center gap-2",children:[s.jsx(ue,{className:"h-6 w-6 text-blue-600"}),"Product Approval Request"]}),s.jsx(ce,{className:"text-slate-500",children:"Review product details and certificate before approving."})]}),e[17]=B):B=e[17];let x;e[18]!==t||e[19]!==i?(x=t&&s.jsxs("div",{className:"grid grid-cols-2 gap-6 py-4",children:[s.jsxs("div",{className:"space-y-4 col-span-2 md:col-span-1",children:[s.jsx("h3",{className:"font-semibold text-slate-900 border-b pb-2",children:"Taxpayer Information"}),s.jsxs("div",{className:"space-y-1",children:[s.jsx("p",{className:"text-sm text-slate-500",children:"Company Name"}),s.jsx("p",{className:"font-medium text-slate-900",children:t.taxpayer.company_name})]}),s.jsxs("div",{className:"space-y-1",children:[s.jsx("p",{className:"text-sm text-slate-500",children:"Tax ID (TIN)"}),s.jsx("p",{className:"font-mono text-slate-700",children:t.taxpayer.tin})]})]}),s.jsxs("div",{className:"space-y-4 col-span-2 md:col-span-1",children:[s.jsx("h3",{className:"font-semibold text-slate-900 border-b pb-2",children:"Product Details"}),s.jsxs("div",{className:"space-y-1",children:[s.jsx("p",{className:"text-sm text-slate-500",children:"Product Name"}),s.jsx("p",{className:"font-medium text-slate-900",children:t.product.name})]}),s.jsxs("div",{className:"space-y-1",children:[s.jsx("p",{className:"text-sm text-slate-500",children:"Category"}),s.jsx("p",{className:"font-medium text-slate-700 capitalize",children:t.product.category&&typeof t.product.category=="object"?String(t.product.category.name||"Uncategorized"):String(t.product.category||"Uncategorized")})]}),s.jsx("div",{className:"grid grid-cols-2 gap-2",children:s.jsxs("div",{className:"space-y-1",children:[s.jsx("p",{className:"text-sm text-slate-500",children:"Unit Type"}),s.jsx("p",{className:"font-medium text-slate-700 capitalize",children:t.product.unit_type})]})}),s.jsxs("div",{className:"space-y-1 pt-2",children:[s.jsxs("label",{className:"text-sm text-slate-500 block mb-1",children:["Set Stamp Price ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsxs("div",{className:"relative",children:[s.jsx(ye,{type:"number",step:"0.01",min:"0",placeholder:"0.00",value:i,onChange:a=>ee(a.target.value)}),s.jsx("span",{className:"absolute right-3 top-2.5 text-sm text-slate-500",children:"CDF"})]}),s.jsxs("p",{className:"text-xs text-slate-500",children:["Price per ",t.product.unit_type," unit."]})]})]}),s.jsx("div",{className:"space-y-4 col-span-2 border-t pt-4",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold text-slate-900",children:"Certificate Document"}),s.jsx("p",{className:"text-sm text-slate-500",children:"Uploaded proof of authorization."})]}),t.certificate_path?s.jsxs("a",{href:t.certificate_path,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-2 px-4 py-2 bg-slate-100 text-slate-700 rounded-lg hover:bg-slate-200 transition-colors font-medium text-sm",children:[s.jsx(ne,{className:"w-4 h-4"}),"View Document"]}):s.jsxs(te,{variant:"destructive",className:"flex items-center gap-1",children:[s.jsx(de,{className:"w-3 h-3"})," Not Uploaded"]})]})})]}),e[18]=t,e[19]=i,e[20]=x):x=e[20];let L;e[21]===Symbol.for("react.memo_cache_sentinel")?(L=s.jsx(_,{variant:"outline",onClick:()=>S(!1),children:"Cancel"}),e[21]=L):L=e[21];let O;e[22]===Symbol.for("react.memo_cache_sentinel")?(O=s.jsxs(_,{variant:"destructive",onClick:()=>P(!0),children:[s.jsx(Se,{className:"mr-2 h-4 w-4"})," Reject"]}),e[22]=O):O=e[22];const Q=!!l||!i;let p;e[23]!==l||e[24]!==t?.id?(p=l===t?.id?s.jsx(me,{className:"mr-2 h-4 w-4 animate-spin"}):s.jsx(Ce,{className:"mr-2 h-4 w-4"}),e[23]=l,e[24]=t?.id,e[25]=p):p=e[25];let h;e[26]!==J||e[27]!==Q||e[28]!==p?(h=s.jsxs(re,{className:"gap-2 sm:gap-0 border-t pt-4",children:[L,O,s.jsxs(_,{className:"bg-emerald-600 hover:bg-emerald-700 text-white",onClick:J,disabled:Q,children:[p,"Approve Product"]})]}),e[26]=J,e[27]=Q,e[28]=p,e[29]=h):h=e[29];let f;e[30]!==x||e[31]!==h?(f=s.jsxs(ie,{className:"sm:max-w-2xl bg-white text-slate-900 border-slate-200",children:[B,x,h]}),e[30]=x,e[31]=h,e[32]=f):f=e[32];let u;e[33]!==q||e[34]!==f?(u=s.jsx(oe,{open:q,onOpenChange:S,children:f}),e[33]=q,e[34]=f,e[35]=u):u=e[35];let E;e[36]===Symbol.for("react.memo_cache_sentinel")?(E=s.jsxs(ae,{children:[s.jsx(le,{children:"Reject Product Request"}),s.jsx(ce,{children:"Please provide a reason for rejection. This will be visible to the taxpayer."})]}),e[36]=E):E=e[36];let H;e[37]===Symbol.for("react.memo_cache_sentinel")?(H=s.jsx(ve,{children:"Rejection Reason"}),e[37]=H):H=e[37];let U;e[38]===Symbol.for("react.memo_cache_sentinel")?(U=a=>Z(a.target.value),e[38]=U):U=e[38];let j;e[39]!==r?(j=s.jsx("div",{className:"space-y-4 py-4",children:s.jsxs("div",{className:"space-y-2",children:[H,s.jsx(_e,{placeholder:"e.g. Invalid certificate, Incorrect pricing...",value:r,onChange:U,rows:3})]})}),e[39]=r,e[40]=j):j=e[40];let V;e[41]===Symbol.for("react.memo_cache_sentinel")?(V=s.jsx(_,{variant:"ghost",onClick:()=>P(!1),children:"Cancel"}),e[41]=V):V=e[41];const W=!r||!!l;let N;e[42]!==l?(N=l?s.jsx(me,{className:"mr-2 h-4 w-4 animate-spin"}):null,e[42]=l,e[43]=N):N=e[43];let g;e[44]!==K||e[45]!==W||e[46]!==N?(g=s.jsxs(re,{children:[V,s.jsxs(_,{variant:"destructive",onClick:K,disabled:W,children:[N,"Confirm Rejection"]})]}),e[44]=K,e[45]=W,e[46]=N,e[47]=g):g=e[47];let b;e[48]!==j||e[49]!==g?(b=s.jsxs(ie,{className:"sm:max-w-md bg-white text-slate-900",children:[E,j,g]}),e[48]=j,e[49]=g,e[50]=b):b=e[50];let v;e[51]!==G||e[52]!==b?(v=s.jsx(oe,{open:G,onOpenChange:P,children:b}),e[51]=G,e[52]=b,e[53]=v):v=e[53];let $;return e[54]!==m||e[55]!==u||e[56]!==v?($=s.jsxs(je,{breadcrumbs:A,children:[I,s.jsxs("div",{className:"flex h-full flex-1 flex-col gap-6 p-6 bg-slate-50",children:[z,m,u,v]})]}),e[54]=m,e[55]=u,e[56]=v,e[57]=$):$=e[57],$}function we(X){return X.stopPropagation()}export{Ge as default};
